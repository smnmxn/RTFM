<%
  # Activity stages for recommendation generation
  recommendation_stages = [
    "Reviewing your sections...",
    "Identifying common questions...",
    "Analyzing user needs...",
    "Drafting article outlines...",
    "Matching content to topics...",
    "Finalizing recommendations..."
  ]
%>

<% if project.all_recommendations_generated? %>
  <%= render "onboarding/shared/completion_state",
      title: "All done!",
      message: "Redirecting to your help centre...",
      icon: "check",
      redirect_url: project_path(project) %>
<% else %>
  <% recommendations_start = project.sections.minimum(:recommendations_started_at) %>
  <div class="p-6">
    <div class="text-center mb-6">
      <div class="inline-flex items-center justify-center w-16 h-16 rounded-full app-surface-alt mb-4">
        <%= heroicon "sparkles", variant: :outline, options: { class: "w-8 h-8 app-accent-text animate-pulse" } %>
      </div>
      <h3 class="text-xl font-semibold app-text mb-2">Creating your help centre</h3>
      <p class="app-text-secondary text-sm max-w-md mx-auto">
        We're generating personalized article recommendations for each section.
      </p>
    </div>

    <%= render "onboarding/shared/loading_banner",
        stages: recommendation_stages,
        stage_duration: 15,
        start_time: recommendations_start,
        variant: "checklist" %>

    <%= render "onboarding/shared/page_warning" %>
  </div>
<% end %>
