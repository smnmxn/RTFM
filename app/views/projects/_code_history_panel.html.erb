<!-- Code History Header -->
<div class="px-6 py-4 border-b app-border flex-shrink-0">
  <div class="flex items-center justify-between">
    <div>
      <h2 class="text-xl font-semibold app-text">Code History</h2>
      <p class="mt-1 text-sm app-text-secondary">
        Commits and pull requests, sorted by date.
      </p>
    </div>
  </div>

  <!-- Analysis Baseline Indicator -->
  <% if project.analysis_commit_sha.present? %>
    <div class="mt-3 flex items-center gap-2 text-sm">
      <span class="inline-flex items-center gap-1.5 px-2 py-1 rounded-md app-accent-light app-accent-on-light border border-[color:var(--app-accent)]">
        <%= heroicon "flag", options: { class: "w-3.5 h-3.5" } %>
        <span class="font-medium">Docs baseline:</span>
        <code class="font-mono text-xs"><%= project.analysis_commit_sha.first(7) %></code>
        <% if project.analyzed_at.present? %>
          <span class="app-accent-text">(<%= time_ago_in_words(project.analyzed_at) %> ago)</span>
        <% end %>
      </span>
      <% last_check = project.article_update_checks.completed.recent.first %>
      <% if last_check && last_check.target_commit_sha != project.analysis_commit_sha %>
        <span class="inline-flex items-center gap-1.5 px-2 py-1 rounded-md bg-green-50 text-green-700 border border-green-100">
          <%= heroicon "arrow-path", options: { class: "w-3.5 h-3.5" } %>
          <span class="font-medium">Last check:</span>
          <code class="font-mono text-xs"><%= last_check.short_target_sha %></code>
          <span class="text-green-500">(<%= time_ago_in_words(last_check.completed_at) %> ago)</span>
        </span>
      <% end %>
    </div>
  <% end %>
</div>

<!-- Timeline Content (lazy loaded) -->
<div class="flex-1 overflow-y-auto p-6">
  <%= turbo_frame_tag "code-history-timeline",
      src: code_history_project_path(project),
      loading: "lazy" do %>
    <div class="flex items-center justify-center py-12">
<div class="flex items-center gap-2 app-text-secondary">
        <%= spinner_icon(size: "w-5 h-5") %>
        <span>Loading code history...</span>
      </div>
    </div>
  <% end %>
</div>
