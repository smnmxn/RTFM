<%# locals: (project:, saved: false) %>
<%= turbo_frame_tag "update_strategy_form" do %>
  <div class="border border-gray-200 rounded-lg">
    <div class="px-4 py-3 bg-gray-50 border-b border-gray-200 rounded-t-lg">
      <h3 class="text-lg font-medium text-gray-900">Recommendations</h3>
      <p class="text-sm text-gray-500 mt-1">When should we check your code for new article recommendations?</p>
    </div>

    <%= form_with model: project,
                  url: update_strategy_project_path(project),
                  method: :patch,
                  class: "divide-y divide-gray-200" do |form| %>

      <div class="p-4 space-y-3" data-controller="radio-card">
        <% Project::UPDATE_STRATEGIES.each do |label, value, description| %>
          <% selected = project.update_strategy_value == value %>
          <label data-radio-card-target="card"
                 data-action="click->radio-card#select"
                 class="flex items-start gap-3 p-3 rounded-lg border cursor-pointer transition-colors
                        <%= selected ? 'border-indigo-300 bg-indigo-50' : 'border-gray-200 hover:bg-gray-50' %>">
            <%= form.radio_button :update_strategy, value,
                checked: selected,
                class: "mt-0.5 h-4 w-4 text-indigo-600 border-gray-300 focus:ring-indigo-500" %>
            <div>
              <span class="block text-sm font-medium text-gray-900"><%= label %></span>
              <span class="block text-sm text-gray-500 mt-0.5"><%= description %></span>
            </div>
          </label>
        <% end %>
      </div>

      <!-- Submit -->
      <div class="p-4 bg-gray-50 rounded-b-lg flex items-center justify-between">
        <% if saved %>
          <span class="text-sm text-green-600 flex items-center gap-1">
            <%= heroicon "check-circle", options: { class: "w-4 h-4" } %>
            Saved
          </span>
        <% else %>
          <span></span>
        <% end %>
        <%= form.submit "Save",
            class: "px-4 py-2 bg-indigo-600 text-white rounded-lg hover:bg-indigo-700 transition-colors text-sm font-medium cursor-pointer" %>
      </div>
    <% end %>
  </div>
<% end %>
