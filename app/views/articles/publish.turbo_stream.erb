<%= turbo_stream.replace dom_id(@article), partial: "articles/card", locals: { article: @article } %>
<%= turbo_stream.replace "article_header", partial: "articles/header", locals: { article: @article } %>

<%# Update the Articles tab editor %>
<%= turbo_stream.replace "articles-editor-frame" do %>
  <%= render "projects/articles_editor",
      article: @article,
      project: @article.project,
      sections: @article.project.sections.visible.ordered %>
<% end %>

<%# Update articles tab badge %>
<%= turbo_stream.replace "articles-tab-badge" do %>
  <%= render "projects/articles_tab_badge", project: @article.project %>
<% end %>

<%# Update folder tree to refresh published status indicator %>
<%= turbo_stream.replace "articles-folder-tree" do %>
  <%= render "projects/articles_folder_tree",
      sections: @article.project.sections.visible.ordered,
      uncategorized_articles: @article.project.articles.for_folder_tree.where(section: nil).ordered,
      project: @article.project,
      selected_article_id: @article.id %>
<% end %>

<%# Update inbox to remove article if it was there (now approved) %>
<% inbox_articles = @article.project.articles
    .where(review_status: :unreviewed)
    .where(generation_status: [:generation_pending, :generation_running, :generation_completed])
    .includes(:section)
    .order(created_at: :asc) %>
<%= turbo_stream.replace "articles-section" do %>
  <%= render "projects/inbox_articles_section",
      inbox_articles: inbox_articles,
      next_item: nil %>
<% end %>

<%# Update inbox progress %>
<%= turbo_stream.replace "inbox-progress" do %>
  <%= render "projects/inbox_progress", project: @article.project %>
<% end %>

<%# Update inbox tab badge %>
<%= turbo_stream.replace "inbox-tab-badge" do %>
  <%= render "projects/inbox_tab_badge", project: @article.project %>
<% end %>
